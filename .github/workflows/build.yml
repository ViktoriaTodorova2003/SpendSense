name: CI/CD Pipeline

on:
  push:
    branches:
      - main  # Change to your default branch if it's different

jobs:
  build:
    runs-on: ubuntu-latest

    services:
      docker:
        image: docker:19.03.12
        options: --privileged
        ports:
          - 80:80
          - 8080:8080

    steps:
      # Step 1: Checkout code from the repository
      - name: Checkout code
        uses: actions/checkout@v2

      # Step 2: Set up Docker Buildx
      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v1

      # Step 3: Set up Docker Compose
      - name: Set up Docker Compose and start services
        run: |
          docker-compose -f ./Implementation/services/docker-compose.yml up -d  # Start services in detached mode

      # Step 4: Wait for services to be ready
      - name: Wait for services to be ready
        run: |
          sleep 30  # Adjust the sleep time as needed to ensure services are fully initialized

      # Step 5: Run k6 tests inside the k6 container
      - name: Run k6 tests
        run: |

